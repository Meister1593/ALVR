{
  "id": "com.valvesoftware.Steam.Utility.nanvr",
  "branch": "stable",
  "sdk": "org.freedesktop.Sdk//24.08",
  "sdk-extensions": [
    "org.freedesktop.Sdk.Extension.llvm19",
    "org.freedesktop.Sdk.Extension.rust-stable"
  ],
  "runtime": "com.valvesoftware.Steam",
  "runtime-version": "stable",
  "appstream-compose": false,
  "separate-locales": false,
  "build-extension": true,
  "build-options": {
    "append-path": "/usr/lib/sdk/llvm19/bin:/usr/lib/sdk/rust-stable/bin",
    "build-args": [
      "--share=network",
      "--filesystem=xdg-data"
    ],
    "strip": true,
    "env": {
      "RUST_BACKTRACE": "full"
    }
  },
  "finish-args": [
    "--share=ipc",
    "--share=network",
    "--device=all",
    "--filesystem=home",
    "--talk-name=org.freedesktop.Notifications"
  ],
  "modules": [
    {
      "name": "nanvr",
      "buildsystem": "simple",
      "build-commands": [
        "mkdir -p /app/utils/nanvr/bin",
        "cd nanvr/launcher",
        "cargo xtask build-server-deps",
        "cargo xtask build-launcher --profile release",
        "mv '/run/build/nanvr/build/nanvr_launcher/NaNVR Launcher' /app/utils/nanvr/bin/nanvr_launcher",
        " # get read-only errors from following lines - because this is an extension - so leave as comments until someone figures this out",
        " # install -D dashboard.ico /app/share/icons/launcher.ico",
        " # install -D com.valvesoftware.Steam.Utility.nanvr.desktop /app/share/applications/com.valvesoftware.Steam.Utility.nanvr.desktop"
      ],
      "sources": [
        {
          "type": "dir",
          "path": "../../../"
        }
      ]
    }
  ]
}